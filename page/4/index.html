<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1">
<script src=/js/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0,theme:"neutral",securityLevel:"loose"})</script>
<link href=/css/fonts.css rel=stylesheet type=text/css>
<title>Yogesh Dhimate</title><link rel=stylesheet href=/css/hugo-octopress.css>
<link rel=stylesheet href=/css/fork-awesome.min.css>
<link href=https://www.dhimate.com/favicon.png rel=icon>
<link href=/index.xml rel=alternate type=application/rss+xml title="Yogesh Dhimate">
<meta name=description content>
<meta name=keywords content="[Yogesh Dhimate dhimate MuleSoft]">
<meta name=author content="Yogesh Dhimate">
<meta name=generator content="Hugo 0.93.0">
</head><body>
<header role=banner>
<hgroup>
<h1><a href=https://www.dhimate.com/>Yogesh Dhimate</a></h1><h2>Notes to Myself</h2></hgroup></header><nav role=navigation>
<fieldset class=mobile-nav>
<select onchange="location=this.value"><option value>Navigate…</option><option value=https://www.dhimate.com/about/>» About Me!</option><option value=https://www.dhimate.com/r%C3%A9sum%C3%A9/>» Résumé</option><option value=https://www.dhimate.com/blog/>» Blog</option><option value=https://www.dhimate.com/books/>» Bookshelf</option></select>
</fieldset><ul class=main-navigation>
<li><a href=https://www.dhimate.com/about/ title="About Me!" rel="noopener noreferrer">About Me!</a></li><li><a href=https://www.dhimate.com/r%C3%A9sum%C3%A9/ title=Résumé rel="noopener noreferrer">Résumé</a></li><li><a href=https://www.dhimate.com/blog/ title=Blog rel="noopener noreferrer">Blog</a></li><li><a href=https://www.dhimate.com/books/ title=Bookshelf rel="noopener noreferrer">Bookshelf</a></li></ul><ul class=subscription>
<a href=https://www.dhimate.com/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
</ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer">
<fieldset role=search>
<input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://www.dhimate.com/>
</fieldset></form></nav><div id=main>
<div id=content>
<div class=blog-index>
<article>
<header>
<p class=meta>Jan 6, 2021
- 3 minute read
- <a class=label href=https://www.dhimate.com/categories/personal/>Personal </a>
</p><h1 class=entry-title>
<a href=https://www.dhimate.com/2021/drinking-water-habit/>Drinking Water Habit</a>
</h1></header><p>I discovered that the easiest way to start drinking more water is to always keep a water bottle with me. Before going to bed, I keep a bottle of water next to the bed. The idea is, when I wake up, the first thing I see is the water bottle. I drink that bottle before getting out of bed. This system helps me get a significant headstart in meeting my daily water drinking quota.</p><p>A few years back I was consulting for a client in Minneapolis. I traveled every other week to Minneapolis to work from their office. I worked with them for almost a year. It was fun and enjoyable work. During that time I developed a good camaraderie with my colleagues there. When I started working with them I noticed that they had a similar - effortless - system to drink more water during office hours.</p><p>Our office in Minneapolis was a repurposed shopping complex. It was a huge single-story building with a large parking place all around it. Our sitting arrangement was based on the &lsquo;open office&rsquo; concept. In this arrangement, each team would get a or working area - but not individual cubicles for each team member. This improves the collaboration and communication within the team. Our working area was in one corner of the building. It was diagonally opposite to the cafeteria, which was located in another corner of the building. There was a water fountain nearby our working area. My colleagues followed a system to only get water from the cafeteria, or the water-fountain near the cafeteria. Like clockwork, we used to get up every couple of hours, walk to the cafeteria, refill our bottles, and get back to the desk. Without consciously putting any effort, or setting specific goals, this simple system ensured that we drink enough water throughout the day. The other advantage was getting some sunlight and fresh air when the weather was nice. Or simply getting out of the chair and get our bodies moving. Drinking more water also ensured more restroom visits, so that was an additional &lsquo;get out of the chair&rsquo; bonus. When I was not in the office, and working from home, I didn&rsquo;t drink enough water. I did not have an effortless system in place to develop this habit.</p><p>My brain is lazy. It wants to conserve energy. And so instead of looking at each problem and providing an appropriate solution, it falls into usual patterns. To develop a good habit, I need to have an effortless system. It should be simple. e.g. Keeping a water bottle with me.</p></article><article>
<header>
<p class=meta>Jan 2, 2021
- 5 minute read
- <a class=label href=https://www.dhimate.com/categories/programming/>Programming </a>
</p><h1 class=entry-title>
<a href=https://www.dhimate.com/2021/how-to-use-netcat-to-debug-cloudhub-networking-issues/>How to Use Netcat to Debug Cloudhub Networking Issues</a>
</h1></header><p>This is a simple trick I use to debug connection issues with the mule app deployed to CloudHub.</p><p>First of all its important to understand that there are different ways to set up your application</p><p><strong>1. Using shared load balancer (i.e. cloudhub.io domain) with HTTP protocol.</strong></p><p>In this scenario, the client application makes a request to a shared load balancer URL using <strong>HTTP</strong> protocol. The SLB forwards the request to the upstream mule application listening on port 8081.</p><p>Note that in this scenario the SLB URL <em>receives</em> the request on port 80, and forwards it to mule application listening on port 8081.
<div class=mermaid align=center>
flowchart LR
l1[Shared Load Balancer]-.->c1
subgraph A[Shared Load Balancer w/ HTTP]
u(client)--http-->c1
c1(hello-world.cloudhub.io<br>)--port 8081-->a1
subgraph VPC 10.0.0.0/24
a1(mule-worker-hello-world.cloudhub.io:8081)--->id1((hello-world))
end
end
style A fill:#FFF,stroke:#DDD,stroke-width:2px
</div></p><p><strong>2. Using shared load balancer (i.e. cloudhub.io domain) with HTTPS protocol.</strong></p><p>In this scenario, the client application makes a request to a shared load balancer URL using <strong>HTTPS</strong> protocol. The SLB forwards the request to the upstream mule application listening on port 8082.</p><p>Note that in this scenario the SLB URL <em>receives</em> the request on port 443, and forwards it to mule application listening on port 8082.
<div class=mermaid align=center>
flowchart LR
l1[Shared Load Balancer]-.->c1
subgraph B[Shared Load Balancer w/ HTTPS]
u(client)--https-->c1
c1(hello-world.cloudhub.io<br>)--port 8082-->a1
subgraph VPC 10.0.0.0/24
a1(mule-worker-hello-world.cloudhub.io:8082)--->id1((hello-world))
end
end
style B fill:#FFF,stroke:#DDD,stroke-width:2px
</div></p><p><strong>3. Using dedicated load balancer (i.e. vanity domain) with HTTPS protocol.</strong></p><p>In this scenario, the client application makes a request to a dedicated load balancer URL(exposed by a vanity domain) using <strong>HTTPS</strong> protocol. The DLB forwards the request to the upstream mule application listening on port 8091.</p><p>Note that in this scenario the DLB URL <em>receives</em> the request on port 443, and forwards it to mule application listening on port 8091.
<div class=mermaid align=center>
flowchart LR
l1[Dedicated Load Balancer<br>Vanity Domain]-.->c1
subgraph C[Dedicated Load Balancer w/ upstream HTTP]
u(client)--https-->c1
c1(api.example.com<br>)--port 8091-->a1
subgraph VPC 10.0.0.0/24
a1(mule-worker-hello-world.cloudhub.io:8091)-->id1((hello-world))
end
end
style C fill:#FFF,stroke:#DDD,stroke-width:2px,font-face:Ubuntu
</div></p><p><strong>4. Using dedicated load balancer (i.e. vanity domain) with HTTPS protocol.</strong></p><p>In this scenario, the client application makes a request to a dedicated load balancer URL(exposed by a vanity domain) using <strong>HTTPS</strong> protocol. The DLB forwards the request to the upstream mule application listening on port 8092.</p><p>Note that in this scenario the DLB URL <em>receives</em> the request on port 443, and forwards it to mule application listening on port 8092.
<div class=mermaid align=center>
flowchart LR
l1[Dedicated Load Balancer<br>Vanity Domain]-.->c1
subgraph C[Dedicated Load Balancer w/ upstream HTTPS]
u(client)--https-->c1
c1(api.example.com<br>)--port 8092-->a1
subgraph VPC 10.0.0.0/24
a1(mule-worker-hello-world.cloudhub.io:8092)-->id1((hello-world))
end
end
style C fill:#FFF,stroke:#DDD,stroke-width:2px,font-face:Ubuntu
</div></p><p><strong>5. Not using load balancers.</strong></p><p>This is one of those scenarios where you are not using Anypoint Platform load balancers. You are either using third-party load balancers, or your applications are using non HTTP protocols like a simple socket, or MLLP. In this case, the client application makes a request directly to the application (mule-worker).
<div class=mermaid align=center>
flowchart LR
u(client)--HTTPS-->a1
subgraph VPC 10.0.0.0/24
a1(mule-worker-hello-world.cloudhub.io:8092)-->id1((hello-world))
end
</div></p><p>As seen above, to make your application endpoint available to the clients</p><ul>
<li>When using a shared load balancer, your application should be listening on an appropriate port (8081 or 8082)</li><li>When using a dedicated load balancer, your application should be listening on an appropriate port (8091 or 8092), and the load balancer&rsquo;s upstream HTTP protocol should be configured properly.</li><li>The VPC firewall should be configured properly to allow the ingress traffic on the appropriate port.</li></ul><p>If there is a misconfiguration, your application endpoint will not be accessible. Your clients will get errors like &lsquo;Bad Gateway&rsquo;, or &lsquo;Timeout&rsquo;. The easiest way to debug these types of errors is to use netcat to perform port scanning and identify open ports on your application.</p><p>For example, to check if your application <code>hello-httpbin</code> is listening on port 8081 you can use</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>
</span></span><span style=display:flex><span>  nc -w <span style=color:#ae81ff>1</span> -G <span style=color:#ae81ff>1</span> -z -v mule-worker-hello-httpbin.cloudhub.io <span style=color:#ae81ff>8081</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Connection to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8081</span> <span style=color:#f92672>[</span>tcp/sunproxyadmin<span style=color:#f92672>]</span> succeeded!
</span></span></code></pre></div><p>In this you can see, the application name is prefixed with <code>mule-worker</code>, to get the correct DNS name. For more details about this convention, please see the DNS records section in <a href=https://docs.mulesoft.com/runtime-manager/cloudhub-networking-guide#dns-records>Cloudhub Networking Guide</a>. The other options of netcat (or nc) are as follows</p><ul>
<li>-w: Timeout when a connection is idle for more than specified seconds.</li><li>-G: TCP connection timeout in seconds.</li><li>-z: Just scan for listening daemons, without sending any data to them.</li><li>-v: Give more verbose output.</li></ul><p>If you are not sure about the specific open port in your application, you can specify the range and identify all open ports using</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>
</span></span><span style=display:flex><span>  nc -w <span style=color:#ae81ff>1</span> -G <span style=color:#ae81ff>1</span> -z -v mule-worker-hello-httpbin.cloudhub.io 8081-8092
</span></span><span style=display:flex><span>  Connection to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8081</span> <span style=color:#f92672>[</span>tcp/sunproxyadmin<span style=color:#f92672>]</span> succeeded!
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8082</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Connection refused
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8083</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8084</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8085</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8086</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8087</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8088</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8089</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8090</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Operation timed out
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8091</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Connection refused
</span></span><span style=display:flex><span>  nc: connectx to mule-worker-hello-httpbin.cloudhub.io port <span style=color:#ae81ff>8092</span> <span style=color:#f92672>(</span>tcp<span style=color:#f92672>)</span> failed: Connection refused
</span></span></code></pre></div><p>In this, you can see that the application only has port 8081 open. Also interesting to note that the ports 8082, 8091, and 8092 are &lsquo;refusing connection&rsquo;, as they are allowed in the firewall but they are not exposed in the application. Whereas for the remaining ports we are getting an &lsquo;Operation timed out&rsquo; error as they are blocked at the firewall.</p><p>The simple netcat/nc utility has saved me a lot of time. I hope it helps you as well.</p></article><article>
<header>
<p class=meta>Dec 31, 2020
- 2 minute read
- <a class=label href=https://www.dhimate.com/categories/personal/>Personal </a>
</p><h1 class=entry-title>
<a href=https://www.dhimate.com/2020/recap-of-2020/>Recap of 2020</a>
</h1></header><p>The end of the year is the time to pause, look back, and think about how the year went by. I am very grateful and fortunate to had an opportunity to enjoy a reasonably good time in 2020.</p><p>On the personal front</p><ul>
<li>We visited our families in India in January. I enjoyed meeting my parents, brother, in-laws, and friends.</li><li>I did not travel for work and got more time to spend with my wife.</li><li>I started reading books. As a kid, I was an avid reader. The librarian in my town knew me by name. He would hold the books for me. With job and other things taking precedence over the years, I forgot about the books.</li><li>I stopped procrastinating about writing this blog. I had some solid excuses like not having enough content to write, poor writing skills, not enough time with work-related travel, etc. I discovered that none of this matters if I can just sit down and write something.</li><li>I re-started playing Clash of Clans. I enjoyed playing it a few years ago, but got addicted to it and burned out. During the pandemic, I wanted something other than movies to wind down. I downloaded my favorite game again and took it for a spin. I was surprised to find my old clan-mates still playing. Then I realized that I was thinking about this game all wrong. There is no end goal to it. The journey of playing is what makes it enjoyable.</li><li>I was able to stick to my intermittent fasting routine throughout the year, even during my visit to India.</li><li>And the best for the last. I was positively surprised by something magic. :)</li></ul><p>On the professional front</p><ul>
<li>I got promoted to a senior position in the team, started mentoring the team members. By the end of the year, I transitioned to a more exciting role that I am looking forward to in the next year.</li><li>I continued my learning by becoming a Salesforce Ranger, as well as became a Certified Administrator. I also completed the HL7 FHIR training and became proficient in FHIR.</li></ul><p>What are my plans for the next year? I like to keep things simple, so I will continue to do the things I did this year already, but in a more structured way.</p></article><article>
<header>
<p class=meta>Dec 30, 2020
- 4 minute read
- <a class=label href=https://www.dhimate.com/categories/personal/>Personal </a>
</p><h1 class=entry-title>
<a href=https://www.dhimate.com/2020/how-intermittent-fasting-saved-my-life/>How Intermittent Fasting Saved My Life</a>
</h1></header><p>One of my goals for 2020 was to stick to an intermittent fasting routine. I completed 6600 hours of fasting in 2020. On average, that&rsquo;s 18 hours of fasting every day, for 365 days. Other interesting stats include the longest streak of 440 fasts and the longest fast of 37 hours. I did reasonably well to maintain a healthy weight despite stress-induced binge eating during the pandemic.</p><p>My fasting journey started in mid of 2019. In the second half of July 2019, I was experiencing sharp pain in my left arm and shoulder. During that week in the middle of the night, I woke up all sweaty, with shortness of breath. I anxiously started googling for the nearest urgent care location, and the shortest path to reach there, just in case I need to rush. Fortunately in the next few minutes, I regained control of my breath. I drank a glass of water and decided to wait until morning. I visited my primary care physician the next day to find out what&rsquo;s going on, and potentially plan for my angioplasty or bypass surgery (or whatever they do to fix the heart-related problem).</p><p>I like my doctor. He is not aggressive with any medications or prescriptions. His advice usually contains words like an embrace, adapt, or wait. After performing preliminary checks he confirmed that while the incident was indeed frightening, and showed all the symptoms of cardiac arrest, it was not a heart attack! The subsequent lipid profile tests etc confirmed his diagnosis.</p><p>While the diagnosis was good, when I carefully looked at the lab results, my LDL cholesterol was at the upper threshold of the safe range. My BMI was indicating that I was overweight. The pain in my left arm wasn&rsquo;t completely gone. What if my doctor was wrong? This was a clue that I needed to make changes in my lifestyle. Fortunately, two things happened.</p><ol>
<li>I read an interesting <a href=https://www.latimes.com/health/la-he-penn-jillette-weight-loss-20190615-story.html>article</a> about magician Penn Gillette losing 100 pounds by fasting for 3 months. He essentially followed One Meal A Day approach to maintain the weight loss.</li><li>I met a friend who had lost about 20 pounds in 3 months by following the intermittent fasting practice. It was super impressive.</li></ol><p>I started taking deep dive into some internet research to understand the basics of intermittent fasting. While it looks like a modern fad, it has been practiced for centuries by various cultures and religions. For example, Hindu Lunar calendar has a 2-week schedule based on the full moon and new moon. On the 11th day after the full moon and new moon, one fasts from sunrise to sunset. That’s twice a month. It&rsquo;s called <em>Ekadashi</em> fast.</p><p>The physiology of fasting is fascinating. Once you have the food, the digestion kicks in, and food breaks into glucose, amino acids, and fatty acids. Ghrelin or the &lsquo;hunger hormone&rsquo; decreases and insulin increases. Insulin carries the nutrients into cells to be stored as glycogen, fat, etc., or used as energy. This phase - anabolic - lasts for 4 hours.</p><p>After the anabolic phase, the catabolic phase kicks in. For the next 12 hours, your blood glucose continues to drop and the liver starts breaking down glycogen for energy.</p><p>The catabolic phase transitions to the fat-burning phase. That&rsquo;s 16 hours after you ate. As the name indicates, during the fat burning phase fat stores break down for energy. The fat burning phase lasts for 8 hours and transitions into the ketosis (and the deep ketosis phase).</p><div class=mermaid align=center>
graph LR
Z("fa:fa-hamburger")-.->A(Anabolic)
A(Anabolic) -. 0-4<br><br>hrs .-> B(Catabolic)
B(Catabolic) -. 4-16<br><br>hrs .-> C(Fat<br>Burning)
C(Fat<br>Burning) -. 16-24<br><br>hrs .-> D(Ketosis)
D(Ketosis) -. 24-72<br><br>hrs .-> E(Deep<br>Ketosis)
</div><p>I will not go into a lot of technical details here. That&rsquo;s the basic overview of the physiology of fasting.</p><p>Coming back to the point. In August 2019, I started my fasting journey with a 16/8 schedule which meant 16-hour fasting and an 8-hour eating window. Just within a week or so I got used to it. I found it too easy, then I transitioned to the 18/6 schedule. And eventually settled on the 20/4 schedule for most of 2019. I use <a href=https://www.zerofasting.com/>Zero Fasting</a> to keep me motivated. I got the results I hoped for and did not experience any pain in my left arm or shoulder since then.</p><p>Note: To put in Penn Gillette&rsquo;s words. If you take health and nutrition advice from a random internet stranger. You are an idiot.</p></article><article>
<header>
<p class=meta>Dec 29, 2020
- 3 minute read
- <a class=label href=https://www.dhimate.com/categories/programming/>Programming </a>
</p><h1 class=entry-title>
<a href=https://www.dhimate.com/2020/upload-attachments-to-salesforce-using-mulesoft/>Upload Attachments to Salesforce Using MuleSoft</a>
</h1></header><p>This question comes up occasionally in my conversations with customers. Often there is a need to programmatically upload an attachment (a pdf or an image) file to Salesforce using MuleSoft. If the integration developer is not very familiar with the Salesforce Platform, it usually confusing due to the way Salesforce manages the attachments.</p><p>As shown in the following ER diagram, there are multiple entities involved in storing and managing the attachments in Salesforce
<div class=mermaid align=center>
erDiagram
ContentDocument ||--|{ ContentDocumentLink : has
ContentDocument {
string Id
string Title
string PathOnClient
date CreatedDate
}
ContentDocumentLink ||--|| Account : linkedEntity
ContentDocumentLink {
string Id
reference LinkedEntityId
reference ContentDocumentId
picklist ShareType
picklist Visibility
}
Account {
string Id
string AccountNumber
}
ContentDocumentLink ||--|| Contact : linkedEntity
Contact {
string Id
string FirstName
string LastName
}
ContentDocumentLink ||--|| sObject : linkedEntity
sObject {
string Id
string SomeProperty
}
</div>Things to note:</p><ul>
<li>Salesforce attachments are stored in ContentDocument (and ContentVersion) objects.
<ul>
<li>The ContentDocument object is used to retrieve, query, update and delete the latest version of a document.</li><li>The ContentVersion object is used to create, query, retrieve, search, edit, and update a specific version of a Salesforce CRM Content document.</li></ul></li><li>The attachment is stored in ContentDocument (Or ContentVersion) and linked to any sObject (Contact, Account etc) via ContentDocumentLink Object</li><li>Thus, to successfully upload an attachment to Salesforce following needs to happen
<ul>
<li>Upsert an attachment (file) to ContentDocument/ContentVersion object</li><li>Query the ContentDocument/ContentVersion to get the ContentDocumentId</li><li>Use the ContentDocumentId to link to your sObject (Account, Lead Opportunity, etc) by upserting the relationship in the ContentDocumentLink object</li></ul></li></ul><p>Following flow chart shows the general approach to upload an attachment to Salesforce:
<div class=mermaid align=center>
graph TD
A([Start]) -->B[/Get file/]
B --> C{{Prepare ContentDocument}} --> D[(<br>Create <br>ContentDocument)]
D --> E{{Get ContentDocument Id}}
E --> F{{Prepare ContentDocumentLink}}
F --> G[(<br>Create <br>ContentDocumentLink)]
G --> H([End])
</div></p><p>Mule DSL code to achieve this
<figure class=code>
<figcaption>
<span></span>
</figcaption><div class=codewrapper>
<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#f92672>&lt;sub-flow</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Upload Attachment&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;ee:transform</span> 
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Prepare ContentDocument&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ee:message&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ee:set-payload&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;![CDATA[%dw 2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e>                output application/java
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ---
</span></span></span><span style=display:flex><span><span style=color:#75715e>                [
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    {
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        Title: &#34;filename&#34; //Replace this with actual filename,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        PathOnClient: &#34;filename&#34; //Replace this with the path on storage system
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        VersionData: payload.content as Binary {class: &#34;byte[]&#34;}
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        //This is the attachment content
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    }
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ]
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ]]&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/ee:set-payload&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/ee:message&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/ee:transform&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;salesforce:create</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;ContentVersion&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Create ContentDocument&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>config-ref=</span><span style=color:#e6db74>&#34;Salesforce_Config&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;ee:transform</span> <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Get Attachment Id&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ee:variables&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ee:set-variable</span> <span style=color:#a6e22e>variableName=</span><span style=color:#e6db74>&#34;contentVersionId&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>&lt;![CDATA[%dw 2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    output application/java
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    ---
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    payload[0].id
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    ]]&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;/ee:set-variable&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/ee:variables&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/ee:transform&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;salesforce:query</span> 
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Get ContentDocumentId&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>config-ref=</span><span style=color:#e6db74>&#34;Salesforce_Config&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;salesforce:salesforce-query&gt;</span>
</span></span><span style=display:flex><span>                SELECT ContentDocumentId From ContentVersion Where Id = &#39;:contentVersionId&#39;
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/salesforce:salesforce-query&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;salesforce:parameters&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;![CDATA[#[
</span></span></span><span style=display:flex><span><span style=color:#75715e>                output application/java
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ---
</span></span></span><span style=display:flex><span><span style=color:#75715e>                {
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    &#34;contentVersionId&#34; : vars.contentVersionId
</span></span></span><span style=display:flex><span><span style=color:#75715e>                }
</span></span></span><span style=display:flex><span><span style=color:#75715e>            ]
</span></span></span><span style=display:flex><span><span style=color:#75715e>            ]]&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/salesforce:parameters&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/salesforce:query&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;ee:transform</span> <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Prepare ContentDocumentLink&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ee:message&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ee:set-payload&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>&lt;![CDATA[%dw 2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    output application/java
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    ---
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    [
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        {
</span></span></span><span style=display:flex><span><span style=color:#75715e>                            LinkedEntityId: vars.accountId,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                            ContentDocumentId: payload[0].ContentDocumentId,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                            ShareType: &#34;I&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        }
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    ]
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    ]]&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;/ee:set-payload&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/ee:message&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/ee:transform&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;salesforce:create</span> 
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Create ContentDocumentLink&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>config-ref=</span><span style=color:#e6db74>&#34;Salesforce_Config&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;ContentDocumentLink&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/sub-flow&gt;</span></span></span></code></pre></td></tr></table></div></div></div></figure></p><p>With this approach you can easily upload attachments to Salesforce.</p></article><div class=pagination>
<a href=/ aria-label=First class=label-pagination><i class="fa fa-angle-double-left fa-lg"></i></a>
<a href=/page/3/ aria-label=Previous class=label-pagination><i class="fa fa-angle-left fa-lg"></i></a>
<a href=/ class=label-pagination>1</a>
<a href=/page/2/ class=label-pagination>2</a>
<a href=/page/3/ class=label-pagination>3</a>
<a href=/page/4/ class=label-pagination>4</a>
<a href=/page/5/ class=label-pagination>5</a>
<a href=/page/6/ class=label-pagination>6</a>
<a href=/page/5/ aria-label=Next class=label-pagination><i class="fa fa-angle-right fa-lg"></i></a>
<a href=/page/6/ aria-label=Last><i class="fa fa-angle-double-right fa-lg"></i></a>
</div></div><aside class="sidebar thirds">
<section class="first odd">
<h1>Who am I?</h1><p>
I’m Yogesh Dhimate. This is my personal website.
All opinions expressed here are my own.
Click on <a href=/about>About</a> to know more.
</p></section><ul class=sidebar-nav>
<li class=sidebar-nav-item>
<a target=_blank rel="noopener noreferrer" href=https://github.com/dhimate/ title=https://github.com/dhimate/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/ydhimate/ title=https://twitter.com/ydhimate/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/dhimate title=https://www.linkedin.com/in/dhimate><i class="fa fa-linkedin fa-3x"></i></a>
</li></ul><section class=odd>
<h1>Collections</h1><li>
<a href=https://www.dhimate.com/categories/programming/ title=Programming>Programming</a>
</li><li>
<a href=https://www.dhimate.com/tags/mulesoft/ title=MuleSoft>MuleSoft</a>
</li><li>
<a href=https://www.dhimate.com/categories/personal/ title=Personal>Personal</a>
</li></section><section class=even>
<h1>Recent Posts</h1><ul id=recent_posts>
<li class=post>
<a href=/2022/smartlock/>Smartlock</a>
</li><li class=post>
<a href=/2021/facebook-annoyance/>Facebook Annoyance</a>
</li><li class=post>
<a href=/2021/making-clay-ganesha-at-home/>Making Clay Ganesha At Home</a>
</li><li class=post>
<a href=/2021/thinking-in-bets/>Thinking in Bets</a>
</li><li class=post>
<a href=/2021/oci-application/>OCI Application Experience</a>
</li><li class=post>
<a href=/2021/understanding-smart-on-fhir/>Understanding SMART on FHIR</a>
</li></ul></section></aside></div></div><footer role=contentinfo>
<p>Copyright &copy; 2022 Yogesh Dhimate - <a href=https://www.dhimate.com/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.
</p></footer></body></html>