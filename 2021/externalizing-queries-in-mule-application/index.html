<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,theme:'neutral',securityLevel:'loose'})</script><link href=/css/fonts.css rel=stylesheet type=text/css><title>Externalizing Queries in Mule Application</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://www.dhimate.com/favicon.png rel=icon><meta name=description content><meta name=keywords content><meta name=author content="Yogesh Dhimate"><meta name=generator content="Hugo 0.83.0"></head><body><header role=banner><hgroup><h1><a href=https://www.dhimate.com/>Yogesh Dhimate</a></h1><h2>Notes to Myself</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://www.dhimate.com/about/>» About</option><option value=https://www.dhimate.com/r%C3%A9sum%C3%A9/>» Résumé</option><option value=https://www.dhimate.com/blog/>» Blog</option><option value=https://www.dhimate.com/books/>» Bookshelf</option></select></fieldset><ul class=main-navigation><li><a href=https://www.dhimate.com/about/ title=About rel="noopener noreferrer">About</a></li><li><a href=https://www.dhimate.com/r%C3%A9sum%C3%A9/ title=Résumé rel="noopener noreferrer">Résumé</a></li><li><a href=https://www.dhimate.com/blog/ title=Blog rel="noopener noreferrer">Blog</a></li><li><a href=https://www.dhimate.com/books/ title=Bookshelf rel="noopener noreferrer">Bookshelf</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://www.dhimate.com/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Jan 9, 2021
- 2 minute read
- <a href=https://www.dhimate.com/2021/externalizing-queries-in-mule-application/#disqus_thread>Comments</a>
- <a class=label href=https://www.dhimate.com/categories/programming/>Programming</a></p><h1 class=entry-title>Externalizing Queries in Mule Application</h1></header><div class=entry-content><p>I like to keep my code clean, understandable, and readable. It helps the next person who will take over my work. I try my best to avoid any trouble reading, maintaining, and updating the code.
There are recommended and well known best practices about organizing Mule code. It involves better structuring of the project, maintaining configuration files, hiding or securing sensitive information like passwords and API keys, transaction management, or reconnection and caching strategies.</p><p>The lesser-known trick is about externalizing SOQL and SQL queries. Before I knew this trick I organized my SQL queries in properties files, and used spring placeholders like <code>${account.query}</code> or dataweave <code>Mule::p</code> function to inject or read the queries in the code. It is not an elegant approach. It made the properties file difficult to manage and read. Then I discovered <code>${file::}</code> notation to inject the queries. It offers a much better way to externalize the queries.</p><p>Using this notation is easy. In your Mule app, organize your queries in the src/main/resources folder in their own files as shown below.</p><figure><img src=/img/2021/externalize-queries-mule-1.jpg alt=dwarf width=400px></figure><p>Once you organize your queries properly, injecting those queries is easy.</p><figure><img src=/img/2021/externalize-queries-mule-2.jpg alt=dwarf width=600px></figure><p>This organization helps in keeping the XML configuration file readable and easily maintainable.</p><figure class=code><figcaption><span></span></figcaption><div class=codewrapper><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>

<span style=color:#f92672>&lt;mule</span> <span style=color:#a6e22e>xmlns:ee=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/ee/core&#34;</span>
	<span style=color:#a6e22e>xmlns:http=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/http&#34;</span>
	<span style=color:#a6e22e>xmlns:db=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/db&#34;</span>
	<span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/core&#34;</span>
	<span style=color:#a6e22e>xmlns:doc=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/documentation&#34;</span>
	<span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://www.mulesoft.org/schema/mule/core 
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/core/current/mule.xsd
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/db 
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/http 
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/ee/core 
</span><span style=color:#e6db74>		http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd&#34;</span><span style=color:#f92672>&gt;</span>
	<span style=color:#f92672>&lt;flow</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;demo-apiFlow&#34;</span>
		<span style=color:#a6e22e>doc:id=</span><span style=color:#e6db74>&#34;e3653667-121e-47cf-b2a6-33345b66e2e4&#34;</span><span style=color:#f92672>&gt;</span>
		<span style=color:#f92672>&lt;http:listener</span> <span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;/Patient&#34;</span> 
			<span style=color:#a6e22e>doc:id=</span><span style=color:#e6db74>&#34;39e23081-26d6-4469-953d-0efd3219b34f&#34;</span> 
			<span style=color:#a6e22e>config-ref=</span><span style=color:#e6db74>&#34;HTTP_Listener_config&#34;</span> 
			<span style=color:#a6e22e>path=</span><span style=color:#e6db74>&#34;/Patient&#34;</span><span style=color:#f92672>/&gt;</span>
		<span style=color:#f92672>&lt;db:select</span> 
			<span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Select all patients&#34;</span> 
			<span style=color:#a6e22e>doc:id=</span><span style=color:#e6db74>&#34;b7c2a60b-d6bb-431b-bb27-10419910aae6&#34;</span> 
			<span style=color:#a6e22e>config-ref=</span><span style=color:#e6db74>&#34;Database_Config&#34;</span><span style=color:#f92672>&gt;</span>
			<span style=color:#f92672>&lt;db:sql</span> <span style=color:#f92672>&gt;</span><span style=color:#75715e>&lt;![CDATA[${file::sql/select-patients-all.sql}]]&gt;</span><span style=color:#f92672>&lt;/db:sql&gt;</span>
		<span style=color:#f92672>&lt;/db:select&gt;</span>
		<span style=color:#f92672>&lt;ee:transform</span> 
			<span style=color:#a6e22e>doc:name=</span><span style=color:#e6db74>&#34;Prepare response&#34;</span> 
			<span style=color:#a6e22e>doc:id=</span><span style=color:#e6db74>&#34;e2774a96-2f54-4a41-acc2-e8f271b29f52&#34;</span> <span style=color:#f92672>&gt;</span>
			<span style=color:#f92672>&lt;ee:message</span> <span style=color:#f92672>&gt;</span>
				<span style=color:#f92672>&lt;ee:set-payload</span> <span style=color:#a6e22e>resource=</span><span style=color:#e6db74>&#34;dw/patients-all-response.dwl&#34;</span> <span style=color:#f92672>/&gt;</span>
			<span style=color:#f92672>&lt;/ee:message&gt;</span>
		<span style=color:#f92672>&lt;/ee:transform&gt;</span>
	<span style=color:#f92672>&lt;/flow&gt;</span>
<span style=color:#f92672>&lt;/mule&gt;</span></code></pre></td></tr></table></div></div></div></figure></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Yogesh Dhimate</span></span>
<time>Jan 9, 2021</time>
<span class=categories>Tags:
<a class=category href=https://www.dhimate.com/tags/mulesoft>MuleSoft</a></span></p><p class=meta><a class="basic-alignment left" href=https://www.dhimate.com/2021/drinking-water-habit/ title="Drinking Water Habit">Drinking Water Habit</a>
<a class="basic-alignment right" href=https://www.dhimate.com/2021/reflections-on-range-by-david-epstein/ title="Reflections on Range by David Epstein">Reflections on Range by David Epstein</a></p><div id=disqus_thread></div><script type=text/javascript>(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement('script'),a.type='text/javascript',a.async=!0,b='dhimate',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>About Me</h1><p>I’m Yogesh Dhimate. This is my personal website. All opinions expressed here are my own. Click on <a href=/about>About</a> to know more.</p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="noopener noreferrer" href=https://github.com/dhimate/ title=https://github.com/dhimate/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://linkedin.com/in/dhimate title=https://linkedin.com/in/dhimate><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd></section><section class=even><h1>Recent Posts</h1><ul id=recent_posts><li class=post><a href=/2021/certificate-of-authenticity/>Certificate of Authenticity</a></li><li class=post><a href=/2021/february-quick-update/>February Quick Update</a></li><li class=post><a href=/2021/using-epics-fhir-apis-in-mule-4/>Using Epic's FHIR APIs in Mule 4</a></li><li class=post><a href=/2021/how-to-use-different-authentication-options-for-salesforce-connector-in-mule-4/>How to Use Different Authentication Options for Salesforce Connector in Mule 4</a></li><li class=post><a href=/2021/reflections-on-range-by-david-epstein/>Reflections on Range by David Epstein</a></li></ul></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2021 Yogesh Dhimate - <a href=https://www.dhimate.com/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer><script>var _gaq=[['_setAccount','UA-65531716-1'],['_trackPageview']];(function(a,b){var c=a.createElement(b),d=a.getElementsByTagName(b)[0];c.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js',d.parentNode.insertBefore(c,d)})(document,'script')</script></body></html>